{% extends 'webapp/base.html' %}

{% block 'title' %}
    –ú–æ–∏ –≥—Ä—É–ø–ø—ã
{% endblock %}

{% block 'body' %}
<div class="row">
    <h4 class="fw-bold py-3 mb-1"><span class="text-muted fw-light">–ú–æ–∏ –≥—Ä—É–ø–ø—ã / </span> <a href="{% url 'webapp:groups' %}?tlg_id={{ tlg_id }}">–°–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø</a> / {{ group_chat.name }}</h4>

    <div class="col-xl-6 my-form-border">
        <div class="card mb-1 my-form-area">
            <form id="interestsForm" action="{% url 'webapp:group_detail' tlg_id=tlg_id group_id=group_chat.id %}" method="post" enctype="multipart/form-data">
                {% csrf_token %}

                {% if messages %}
                    <ul class="messages">
                        {% for message in messages %}
                            <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}

<!--                –ò–Ω—Ñ–æ —Ä–∞–º–∫–∞ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∑–∞–ø–∏—Å–∏-->
                {% if update_rslt %}
                    <div class="alert alert-success" role="alert">{{ update_rslt }}</div>
                {% endif %}

<!--                –ò–Ω—Ñ–æ —Ä–∞–º–∫–∞ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É "—Ç–µ–≥–Ω—É—Ç—å –≤—Å–µ—Ö" -->
                {% if err_tag_all %}
                    <div class="alert alert-danger" role="alert">{{ err_tag_all }}</div>
                {% elif success_tag_all %}
                    <div class="alert alert-success" role="alert">{{ success_tag_all }}</div>
                {% endif %}

                <div class="row">
                    <div class="col-12 my-form-border">
                        <div class="card my-form-area">

                            <div class="px-4 py-3 mb-1">
                                <a href="{% url 'webapp:groups' %}?tlg_id={{ tlg_id }}" class="btn btn-secondary my-btn-clr" type="submit" id="backButton"> << –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
                            </div>

                            <h5 class="card-header">–ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç "{{ group_chat.name }}"</h5>
                            <div class="card-body demo-vertical-spacing demo-only-element">
                                <small class="text-light fw-semibold">–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–∞–∫–∏—Ö-–ª–∏–±–æ –¥–∞–Ω–Ω—ã—Ö –æ –≥—Ä—É–ø–ø–æ–≤–æ–º —á–∞—Ç–µ, <strong>–Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"</strong>.</small>
                                <hr>

                                <div class="mb-3">
                                    <label class="form-label" for="group_chat_data">
                                        –î–∞–Ω–Ω—ã–µ –æ –≥—Ä—É–ø–ø–æ–≤–æ–º —á–∞—Ç–µ:
                                    </label>
                                    <div class="input-group" id="group_chat_data">
                                        <input type="hidden" name="group_id" value="{{ group_chat.id }}">
                                        <input type="text" value="{{ group_chat.name }}" name="group_name" class="form-control my-filling-fields" placeholder="–Ω–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã" aria-label="–Ω–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã" required>
                                        <input type="text" value="{{ group_chat.group_tg_id }}" name="group_tg_id" class="form-control my-filling-fields" placeholder="https://t.me/+MyChatHash123" aria-label="—Å—Å—ã–ª–∫–∞ –Ω–∞ –≥—Ä—É–ø–ø—É" readonly>
                                    </div>
                                </div>

                                <hr>

                                <div class="flex-grow-1 row">
                                    <div class="col-9 mb-sm-0 mb-0">
                                        <label class="form-label" for="tag_now">
                                            –¢–µ–≥–∞—Ç—å —Å—Ä–∞–∑—É ?
                                        </label>
                                    </div>
                                    <div class="col-3 text-end">
                                        <div class="form-check form-switch">
                                            <input name="tag_now" id="tag_now" class="form-check-input float-end" type="checkbox" role="switch" {% if group_chat.tag_now %} checked {% endif %}>
                                        </div>
                                    </div>
                                    <div class="col-auto form-text">
                                        –ö–∞–∫ —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å—Ç—É–ø–∏—Ç –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç, –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ä–µ–∫–ª–∞–º–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º.<br>–ù–∞–ø—Ä–∏–º–µ—Ä: @NewUser –í–æ—Ç —Ç–µ–±–µ —Ä–µ–∫–ª–∞–º–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
                                    </div>

<!--                                    –¢–µ–≥–Ω—É—Ç—å –≤—Å–µ—Ö-->
                                    <div class="col-9 mb-sm-0 mb-0 mt-2">
                                        <label class="form-label" for="tag_now">
                                            –¢–µ–≥–Ω—É—Ç—å –≤—Å–µ—Ö
                                        </label>
                                    </div>
                                    <div class="col-3 text-end mb-0 mt-2">
                                        <a href="{% url 'webapp:tag_all' tlg_id=tlg_id group_id=group_chat.id %}" type="button" class="btn btn-sm btn-outline-warning">
                                            <i class="tf-icons bx bx-rocket"></i>
                                        </a>
                                    </div>
                                    <div class="col-auto form-text">
                                        –ï—Å–ª–∏ –Ω–∞–∂–∞—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É "—Ç–µ–≥–Ω—É—Ç—å –≤—Å–µ—Ö", –±–æ—Ç —Å–æ–±–µ—Ä–µ—Ç –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —á–∞—Ç–∞ –∏ —É–ø–æ–º—è–Ω–µ—Ç –∏—Ö –≤ –æ–¥–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ —Å —Ä–µ–∫–ª–∞–º–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º.
                                    </div>
                                </div>

                                <hr>

                                <div class="mb-3">
                                    <label class="form-label" for="main_content">
                                        –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç
                                    </label>
                                    <div class="input-group input-group-merge" id="main_content">
                                        <textarea name="msg_text" class="form-control my-filling-fields" aria-label="With textarea" placeholder="–£–∫–∞–∂–∏—Ç–µ —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è" required>{{ group_chat.msg_text }}</textarea>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    {% for i_file in group_chat_files %}
                                        <p>
                                            <input type="checkbox" name="delete_files" value="{{ i_file.id }}"> üóë –£–¥–∞–ª–∏—Ç—å:
                                            <a href="{{ i_file.file.url }}" target="_blank">{{ i_file.file_name }}</a>
                                        </p>
                                    {% empty %}
                                        ü§∑‚Äç‚ôÇÔ∏è –§–∞–π–ª–æ–≤ –Ω–µ—Ç...
                                    {% endfor %}
                                    <input type="file" name="group_chat_files" class="form-control my-filling-fields" aria-describedby="inputGroupFileAddon04" aria-label="Upload" multiple>
                                    <div class="col-auto form-text">
                                        –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏, —Ç–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ –∏—Ö –≤ —ç—Ç–æ–π —Ñ–æ—Ä–º–µ.
                                    </div>
                                </div>

                                <hr>

                                <div class="mb-3">
<!--                                    <div class="input-group">-->
                                    <div class="demo-inline-spacing">
                                        <button class="btn rounded-pill btn-info btn-outline-primary my-btn-clr" type="submit" id="saveChangesButton">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                                        <a href="{% url 'webapp:group_delete' tlg_id=tlg_id group_id=group_chat.id %}" class="btn rounded-pill btn-info btn-outline-danger my-btn-clr" type="button" id="deleteButton">–£–¥–∞–ª–∏—Ç—å</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –æ—Ç —Ç–µ–ª–µ–≥–∏-->
<script>
  var tgObject = window.Telegram.WebApp;
  tgObject.enableClosingConfirmation()  // –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ WebApp
</script>

<!--—Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ –Ω–µ–π-->
<script>
  let saveChangesButton = document.getElementById('saveChangesButton'); // –ë–µ—Ä–µ–º –∫–Ω–æ–ø–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
  let deleteButton = document.getElementById('deleteButton'); // –ë–µ—Ä–µ–º –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è –≥—Ä—É–ø–ø—ã
  let backButton = document.getElementById('backButton'); // –ë–µ—Ä–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞–∑–∞–¥
  let applicationForm = document.getElementById('interestsForm'); // –ë–µ—Ä–µ–º —Ñ–æ—Ä–º—É
  let inputFileField = document.getElementById('inputGroupFile04'); // –ë–µ—Ä–µ–º input –¥–ª—è —Ñ–∞–π–ª–∞
  saveChangesButton.addEventListener('click', function() {
      saveChangesButton.setAttribute("disabled", "disabled");     // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
      deleteButton.setAttribute("disabled", "disabled");     // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è
      backButton.setAttribute("disabled", "disabled");     // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞–∑–∞–¥
      // inputFileField.setAttribute("type", "hidden");  // –û—Ç–∫–ª—é—á–∞–µ–º input –¥–ª—è —Ñ–∞–π–ª–∞
      saveChangesButton.textContent = '‚åõÔ∏è –û—Ç–ø—Ä–∞–≤–ª—è—é —Ñ–æ—Ä–º—É...';     // –ú–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏
      applicationForm.submit();     // –®–≤—ã—Ä—è–µ–º —Ñ–æ—Ä–º—É –Ω–∞ –±—ç–∫
  });
</script>

{% endblock %}
